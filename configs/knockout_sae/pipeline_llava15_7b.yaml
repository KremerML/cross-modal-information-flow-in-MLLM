model:
  name: "liuhaotian/llava-v1.5-7b"
  target_layer: 12
  d_model: 4096
  conv_mode: "vicuna_v1"
  model_base: null

dataset:
  task_types: ["ChooseAttr"]
  split: "validation"
  refined_dataset: "datasets/GQA_val_correct_question_with_choose_ChooseAttr.csv"
  image_folder: "datasets/images"

experiment:
  output_dir: null
  output_base: "output/knockout_sae"
  name: "knockout_sae_run1"
  use_timestamp: true

knockout:
  flows: ["Image->Question", "Image->Last"]
  window: 1
  filter_correct: true
  normalize_logprob: true
  max_samples: null
  top_k_layers: 5
  batch_size: 1
  num_workers: 2
  output_subdir: "knockout"

sae_reuse:
  recon_threshold: 0.1
  kl_threshold: 0.5
  allow_missing_stats: true
  sample_size: 256
  search_paths:
    - "output/sae_experiments"

feature_identification:
  discrimination_threshold: 2.0
  min_activation: 0.1
  top_k: 50
  min_diff: 0.0
  position_type: "question"
  correctness_metric: "option_logprob"
  logprob_normalize: true
  batch_size: 256
  fallback:
    discrimination_threshold: 1.1
    min_activation: 0.0
    min_diff: 0.0

ablation:
  n_random_features: 50
  n_bootstrap: 1000
  position_type: "question"
  mode: "residual"
  delta_scale: 1.0

evaluation:
  significance_level: 0.05
  primary_metric: "forced_choice_margin"
  logprob_normalize: true
